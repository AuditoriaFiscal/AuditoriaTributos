<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
		xmlns:ui="http://java.sun.com/jsf/facelets"
		xmlns:h="http://java.sun.com/jsf/html"
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:p="http://primefaces.org/ui">

	<ui:include src="template/header.xhtml" />
	
	<body>

		<div id="wrapper">

			<ui:include src="template/nav.xhtml" />
	
			<div id="page-wrapper">
				<div class="row">
					<div class="col-lg-12">
						<h1 class="page-header">Comparação de NFe</h1>
					</div>
				</div>
				<div class="row">
					<div class="col-lg-12">
						<div class="panel panel-default">
							<div class="panel-heading">Inclusão de NFe</div>
							<div class="panel-body">
								<h:form enctype="multipart/form-data">
									<div class="row">
										<div class="col-lg-12">
											<p:messages id="messages" autoUpdate="true" closable="true" />
											<div class="form-group">
												<div class="col-lg-2">
													<p:outputLabel value="Nota Entrada: " />
												</div>
												<div class="col-lg-6">
													<p:fileUpload value="#{documentoBean.arquivoEntrada}"
														mode="simple" skinSimple="true" />
												</div>
												<div class="col-lg-4">
													<p:commandButton value="Comparar NCM Entrada" id="comNCMEntrada" actionListener="#{documentoBean.uploadEntrada}" update="messages tabelaDocumentoEntrada" icon="ui-icon-disk" ajax="false" />
												</div>
											</div>
										</div>
										<br/>
										<div class="col-lg-12">
											<div class="form-group">
												<div class="col-lg-2">
													<p:outputLabel value="Nota Saída: " />
												</div>
												<div class="col-lg-6">
													<p:fileUpload value="#{documentoBean.arquivoSaida}" mode="simple" skinSimple="false" />
												</div>
												<div class="col-lg-4">
													<p:commandButton value="Comparar NCM Saída" id="comNCMSaida" actionListener="#{documentoBean.uploadSaida}" update="messages" icon="ui-icon-disk" ajax="false" />
												</div>
											</div>
										</div>
										<div class="col-lg-12">
											<div class="form-group">
												<div class="col-lg-4">
													<p:commandButton value="Comparar NCM's Entrada e Saida" id="comNCMEntradaSaida" actionListener="#{documentoBean.compararNotasEntradaSaida}" update="@form" icon="ui-icon-disk" ajax="false" />
												</div>
											</div>
										</div>
										<div class="col-lg-12" style="height:50px;"></div>
										<div class="col-lg-12">
											<div class="form-group">
												<p:dataTable id="tabelaDocumentoEntrada" var="documento" value="#{documentoBean.documentoEntrada}" rendered="#{not empty documentoBean.documentoEntrada}">
													<f:facet name="header">
														Resultado Documento entrada
													</f:facet> 	
													<p:column headerText="Id">
														<h:outputText value="#{documento.nomeNota}" />
													</p:column>
													<p:column headerText="Item">
														<ui:repeat var="item" value="#{documento.itens}">
															<p:column headerText="NCM">
																<h:outputText value="#{item.idNcm}" />
																<ui:repeat var="itemResult" value="#{item.itensResult}">
																	<h:outputLabel value="#{itemResult.descricao}" />
																</ui:repeat>
															</p:column>
														</ui:repeat>
													</p:column>
												</p:dataTable>
												    <h:commandLink>
												        <p:graphicImage name="/demo/images/excel.png" />
												        <p:dataExporter type="xls" target="tabelaDocumentoEntrada" fileName="Resultado Documento entrada - #{documento.nomeNota}" pageOnly="false"/>
												    </h:commandLink>
											</div>
										</div>
										<div class="col-lg-12">
											<div class="form-group">
												<p:dataTable id="tabelaDocumentoSaida" var="documento" value="#{documentoBean.documentoSaida}"  rendered="#{not empty documentoBean.documentoSaida}">
													<f:facet name="header">
														Resultado Documento saída
													</f:facet>
													<p:column headerText="Id">
														<h:outputText value="#{documento.nomeNota}" />
													</p:column>
													<p:column headerText="Item">
														<ui:repeat var="item" value="#{documento.itens}">
															<p:column headerText="NCM">
																<h:outputText value="#{item.idNcm}" />
																<ui:repeat var="itemResult" value="#{item.itensResult}">
																	<h:outputLabel value="#{itemResult.descricao}" />
																</ui:repeat>
															</p:column>
														</ui:repeat>
													</p:column>
												</p:dataTable>
											</div>
										</div>
										<div class="col-lg-12" style="height:50px;"></div>
										<div class="col-lg-12">
											<div class="form-group">
												<p:dataTable id="tabelaCamparacaoNfs" var="documento" value="#{documentoBean.documentoEntrada}" rendered="#{not empty documentoBean.documentoEntrada}">
													<f:facet name="header">
														Resultado da comparação dos Documento Entrada - Saida
													</f:facet> 	
													<p:column headerText="Id">
														<h:outputText value="#{documento.nomeNota}" />
													</p:column>
													<p:column headerText="Item">
														<ui:repeat var="item" value="#{documento.itens}">
																<ui:repeat var="itemResult" value="#{item.itensResultNotasCompare}">
																<p:column headerText="NCM">
																<h:outputText value="#{item.idNcm}" />
																	<h:outputLabel value="#{itemResult.descricao}" />
																</p:column>
																</ui:repeat>
														</ui:repeat>
													</p:column>
												</p:dataTable>
											</div>
										</div>
									</div>
								</h:form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>